module.exports=function(t){var n={};function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)e.d(r,o,function(n){return t[n]}.bind(null,o));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=80)}([function(t,n){t.exports=flarum.core.compat.app},function(t,n){t.exports=flarum.core.compat.extend},function(t,n,e){t.exports=e(32)},function(t,n){t.exports=flarum.core.compat["components/Button"]},function(t,n){t.exports=flarum.core.compat["utils/Stream"]},function(t,n){t.exports=flarum.core.compat["components/LogInModal"]},function(t,n){t.exports=flarum.core.compat["components/FieldSet"]},function(t,n){t.exports=flarum.core.compat["helpers/username"]},function(t,n){t.exports=flarum.core.compat["helpers/icon"]},function(t,n,e){var r=e(22)(Object,"create");t.exports=r},function(t,n,e){var r=e(65);t.exports=function(t,n){for(var e=t.length;e--;)if(r(t[e][0],n))return e;return-1}},function(t,n,e){var r=e(71);t.exports=function(t,n){var e=t.__data__;return r(n)?e["string"==typeof n?"string":"hash"]:e.map}},function(t,n){t.exports=flarum.core.compat["components/DiscussionList"]},function(t,n){t.exports=flarum.core.compat["components/HeaderSecondary"]},function(t,n){var e=Array.isArray;t.exports=e},function(t,n,e){var r=e(21),o=e(44);t.exports=function(t){return"symbol"==typeof t||o(t)&&"[object Symbol]"==r(t)}},function(t,n,e){var r=e(17).Symbol;t.exports=r},function(t,n,e){var r=e(40),o="object"==typeof self&&self&&self.Object===Object&&self,i=r||o||Function("return this")();t.exports=i},function(t,n){t.exports=flarum.core.compat["components/SettingsPage"]},function(t,n){t.exports=flarum.core.compat["components/ChangeEmailModal"]},function(t,n){t.exports=flarum.core.compat["common/components/Button"]},function(t,n,e){var r=e(16),o=e(42),i=e(43),a=r?r.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":a&&a in Object(t)?o(t):i(t)}},function(t,n,e){var r=e(52),o=e(57);t.exports=function(t,n){var e=o(t,n);return r(e)?e:void 0}},function(t,n){t.exports=function(t){var n=typeof t;return null!=t&&("object"==n||"function"==n)}},,function(t,n){t.exports=flarum.core.compat["models/Post"]},function(t,n){t.exports=flarum.core.compat.Model},function(t,n){t.exports=flarum.core.compat["components/CommentPost"]},function(t,n){t.exports=flarum.core.compat["components/Post"]},function(t,n){t.exports=flarum.core.compat["common/components/Modal"]},function(t,n,e){var r=e(37);t.exports=function(t,n,e){var o=null==t?void 0:r(t,n);return void 0===o?e:o}},function(t,n){t.exports=flarum.core.compat["components/Modal"]},function(t,n,e){var r=function(t){"use strict";var n=Object.prototype,e=n.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,n,e){return Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[n]}try{s({},"")}catch(t){s=function(t,n,e){return t[n]=e}}function c(t,n,e,r){var o=n&&n.prototype instanceof f?n:f,i=Object.create(o.prototype),a=new j(r||[]);return i._invoke=function(t,n,e){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return S()}for(e.method=o,e.arg=i;;){var a=e.delegate;if(a){var s=x(a,e);if(s){if(s===l)continue;return s}}if("next"===e.method)e.sent=e._sent=e.arg;else if("throw"===e.method){if("suspendedStart"===r)throw r="completed",e.arg;e.dispatchException(e.arg)}else"return"===e.method&&e.abrupt("return",e.arg);r="executing";var c=u(t,n,e);if("normal"===c.type){if(r=e.done?"completed":"suspendedYield",c.arg===l)continue;return{value:c.arg,done:e.done}}"throw"===c.type&&(r="completed",e.method="throw",e.arg=c.arg)}}}(t,e,a),i}function u(t,n,e){try{return{type:"normal",arg:t.call(n,e)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var l={};function f(){}function p(){}function d(){}var h={};h[o]=function(){return this};var m=Object.getPrototypeOf,v=m&&m(m(O([])));v&&v!==n&&e.call(v,o)&&(h=v);var y=d.prototype=f.prototype=Object.create(h);function g(t){["next","throw","return"].forEach((function(n){s(t,n,(function(t){return this._invoke(n,t)}))}))}function b(t,n){var r;this._invoke=function(o,i){function a(){return new n((function(r,a){!function r(o,i,a,s){var c=u(t[o],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==typeof f&&e.call(f,"__await")?n.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):n.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}(o,i,r,a)}))}return r=r?r.then(a,a):a()}}function x(t,n){var e=t.iterator[n.method];if(void 0===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=void 0,x(t,n),"throw"===n.method))return l;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=u(e,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,l;var o=r.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=void 0),n.delegate=null,l):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,l)}function _(t){var n={tryLoc:t[0]};1 in t&&(n.catchLoc=t[1]),2 in t&&(n.finallyLoc=t[2],n.afterLoc=t[3]),this.tryEntries.push(n)}function w(t){var n=t.completion||{};n.type="normal",delete n.arg,t.completion=n}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function O(t){if(t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function n(){for(;++r<t.length;)if(e.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=void 0,n.done=!0,n};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=y.constructor=d,d.constructor=p,p.displayName=s(d,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===p||"GeneratorFunction"===(n.displayName||n.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},g(b.prototype),b.prototype[i]=function(){return this},t.AsyncIterator=b,t.async=function(n,e,r,o,i){void 0===i&&(i=Promise);var a=new b(c(n,e,r,o),i);return t.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},g(y),s(y,a,"Generator"),y[o]=function(){return this},y.toString=function(){return"[object Generator]"},t.keys=function(t){var n=[];for(var e in t)n.push(e);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=O,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!t)for(var n in this)"t"===n.charAt(0)&&e.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(e,r){return a.type="throw",a.arg=t,n.next=e,r&&(n.method="next",n.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=e.call(i,"catchLoc"),c=e.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,n){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&e.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=n&&n<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=n,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),l},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var e=this.tryEntries[n];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),w(e),l}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var e=this.tryEntries[n];if(e.tryLoc===t){var r=e.completion;if("throw"===r.type){var o=r.arg;w(e)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,e){return this.delegate={iterator:O(t),resultName:n,nextLoc:e},"next"===this.method&&(this.arg=void 0),l}},t}(t.exports);try{regeneratorRuntime=r}catch(t){Function("r","regeneratorRuntime = r")(r)}},function(t,n){t.exports=flarum.core.compat["components/LogInButtons"]},function(t,n){t.exports=flarum.core.compat["components/LogInButton"]},function(t,n){t.exports=flarum.core.compat["models/User"]},function(t,n){t.exports=flarum.core.compat["common/utils/Stream"]},function(t,n,e){var r=e(38),o=e(78);t.exports=function(t,n){for(var e=0,i=(n=r(n,t)).length;null!=t&&e<i;)t=t[o(n[e++])];return e&&e==i?t:void 0}},function(t,n,e){var r=e(14),o=e(39),i=e(45),a=e(75);t.exports=function(t,n){return r(t)?t:o(t,n)?[t]:i(a(t))}},function(t,n,e){var r=e(14),o=e(15),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;t.exports=function(t,n){if(r(t))return!1;var e=typeof t;return!("number"!=e&&"symbol"!=e&&"boolean"!=e&&null!=t&&!o(t))||(a.test(t)||!i.test(t)||null!=n&&t in Object(n))}},function(t,n,e){(function(n){var e="object"==typeof n&&n&&n.Object===Object&&n;t.exports=e}).call(this,e(41))},function(t,n){var e;e=function(){return this}();try{e=e||new Function("return this")()}catch(t){"object"==typeof window&&(e=window)}t.exports=e},function(t,n,e){var r=e(16),o=Object.prototype,i=o.hasOwnProperty,a=o.toString,s=r?r.toStringTag:void 0;t.exports=function(t){var n=i.call(t,s),e=t[s];try{t[s]=void 0;var r=!0}catch(t){}var o=a.call(t);return r&&(n?t[s]=e:delete t[s]),o}},function(t,n){var e=Object.prototype.toString;t.exports=function(t){return e.call(t)}},function(t,n){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,n,e){var r=e(46),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,a=r((function(t){var n=[];return 46===t.charCodeAt(0)&&n.push(""),t.replace(o,(function(t,e,r,o){n.push(r?o.replace(i,"$1"):e||t)})),n}));t.exports=a},function(t,n,e){var r=e(47);t.exports=function(t){var n=r(t,(function(t){return 500===e.size&&e.clear(),t})),e=n.cache;return n}},function(t,n,e){var r=e(48);function o(t,n){if("function"!=typeof t||null!=n&&"function"!=typeof n)throw new TypeError("Expected a function");var e=function(){var r=arguments,o=n?n.apply(this,r):r[0],i=e.cache;if(i.has(o))return i.get(o);var a=t.apply(this,r);return e.cache=i.set(o,a)||i,a};return e.cache=new(o.Cache||r),e}o.Cache=r,t.exports=o},function(t,n,e){var r=e(49),o=e(70),i=e(72),a=e(73),s=e(74);function c(t){var n=-1,e=null==t?0:t.length;for(this.clear();++n<e;){var r=t[n];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=a,c.prototype.set=s,t.exports=c},function(t,n,e){var r=e(50),o=e(62),i=e(69);t.exports=function(){this.size=0,this.__data__={hash:new r,map:new(i||o),string:new r}}},function(t,n,e){var r=e(51),o=e(58),i=e(59),a=e(60),s=e(61);function c(t){var n=-1,e=null==t?0:t.length;for(this.clear();++n<e;){var r=t[n];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=a,c.prototype.set=s,t.exports=c},function(t,n,e){var r=e(9);t.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(t,n,e){var r=e(53),o=e(54),i=e(23),a=e(56),s=/^\[object .+?Constructor\]$/,c=Function.prototype,u=Object.prototype,l=c.toString,f=u.hasOwnProperty,p=RegExp("^"+l.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!i(t)||o(t))&&(r(t)?p:s).test(a(t))}},function(t,n,e){var r=e(21),o=e(23);t.exports=function(t){if(!o(t))return!1;var n=r(t);return"[object Function]"==n||"[object GeneratorFunction]"==n||"[object AsyncFunction]"==n||"[object Proxy]"==n}},function(t,n,e){var r,o=e(55),i=(r=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";t.exports=function(t){return!!i&&i in t}},function(t,n,e){var r=e(17)["__core-js_shared__"];t.exports=r},function(t,n){var e=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return e.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},function(t,n){t.exports=function(t,n){return null==t?void 0:t[n]}},function(t,n){t.exports=function(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}},function(t,n,e){var r=e(9),o=Object.prototype.hasOwnProperty;t.exports=function(t){var n=this.__data__;if(r){var e=n[t];return"__lodash_hash_undefined__"===e?void 0:e}return o.call(n,t)?n[t]:void 0}},function(t,n,e){var r=e(9),o=Object.prototype.hasOwnProperty;t.exports=function(t){var n=this.__data__;return r?void 0!==n[t]:o.call(n,t)}},function(t,n,e){var r=e(9);t.exports=function(t,n){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=r&&void 0===n?"__lodash_hash_undefined__":n,this}},function(t,n,e){var r=e(63),o=e(64),i=e(66),a=e(67),s=e(68);function c(t){var n=-1,e=null==t?0:t.length;for(this.clear();++n<e;){var r=t[n];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=a,c.prototype.set=s,t.exports=c},function(t,n){t.exports=function(){this.__data__=[],this.size=0}},function(t,n,e){var r=e(10),o=Array.prototype.splice;t.exports=function(t){var n=this.__data__,e=r(n,t);return!(e<0)&&(e==n.length-1?n.pop():o.call(n,e,1),--this.size,!0)}},function(t,n){t.exports=function(t,n){return t===n||t!=t&&n!=n}},function(t,n,e){var r=e(10);t.exports=function(t){var n=this.__data__,e=r(n,t);return e<0?void 0:n[e][1]}},function(t,n,e){var r=e(10);t.exports=function(t){return r(this.__data__,t)>-1}},function(t,n,e){var r=e(10);t.exports=function(t,n){var e=this.__data__,o=r(e,t);return o<0?(++this.size,e.push([t,n])):e[o][1]=n,this}},function(t,n,e){var r=e(22)(e(17),"Map");t.exports=r},function(t,n,e){var r=e(11);t.exports=function(t){var n=r(this,t).delete(t);return this.size-=n?1:0,n}},function(t,n){t.exports=function(t){var n=typeof t;return"string"==n||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==t:null===t}},function(t,n,e){var r=e(11);t.exports=function(t){return r(this,t).get(t)}},function(t,n,e){var r=e(11);t.exports=function(t){return r(this,t).has(t)}},function(t,n,e){var r=e(11);t.exports=function(t,n){var e=r(this,t),o=e.size;return e.set(t,n),this.size+=e.size==o?0:1,this}},function(t,n,e){var r=e(76);t.exports=function(t){return null==t?"":r(t)}},function(t,n,e){var r=e(16),o=e(77),i=e(14),a=e(15),s=r?r.prototype:void 0,c=s?s.toString:void 0;t.exports=function t(n){if("string"==typeof n)return n;if(i(n))return o(n,t)+"";if(a(n))return c?c.call(n):"";var e=n+"";return"0"==e&&1/n==-1/0?"-0":e}},function(t,n){t.exports=function(t,n){for(var e=-1,r=null==t?0:t.length,o=Array(r);++e<r;)o[e]=n(t[e],e,t);return o}},function(t,n,e){var r=e(15);t.exports=function(t){if("string"==typeof t||r(t))return t;var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}},,function(t,n,e){"use strict";function r(t,n,e,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void e(t)}s.done?n(c):Promise.resolve(c).then(r,o)}function o(t){return function(){var n=this,e=arguments;return new Promise((function(o,i){var a=t.apply(n,e);function s(t){r(a,o,i,s,c,"next",t)}function c(t){r(a,o,i,s,c,"throw",t)}s(void 0)}))}}e.r(n);var i=e(2),a=e.n(i),s=e(1),c=e(0),u=e.n(c),l=(e(33),e(34),e(5)),f=e.n(l),p=(e(20),e(13)),d=e.n(p),h=e(25),v=e.n(h),y=e(26),g=e.n(y),b=(e(35),e(27)),x=e.n(b),_=e(28),w=e.n(_),j=e(3),O=e.n(j),S=(e(6),e(7),e(8),e(4)),L=e.n(S);function k(t,n){return(k=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function E(t,n){t.prototype=Object.create(n.prototype),t.prototype.constructor=t,k(t,n)}var N=e(29),P=e.n(N),I=(e(36),function(t){function n(){return t.apply(this,arguments)||this}E(n,t);var e=n.prototype;return e.oninit=function(n){var e=this;t.prototype.oninit.call(this,n),console.log(n),this.post=this.attrs.post,this.user_id=this.attrs.user_id,this.sender_id=this.attrs.sender_id,this.div_tip_id=this.attrs.div_tip_id,this.address=this.attrs.address,this.tips_amount=this.attrs.tips_amount,this.objtips={post_id:this.post.data.id,user_id:this.user_id,tips_amount:this.tips_amount},this.opay=new Opay2,fetch(u.a.forum.attribute("baseUrl")+"/nb/fundinfo").then((function(t){return t.json()})).then((function(t){return e.fundAddress=t.address}))},e.className=function(){return"addTipModal Modal--small"},e.title=function(){return u.a.translator.trans("chen-nbdomain-login.forum.tip_title")},e.hide=function(){t.prototype.hide.call(this),this.opay.close()},e.content=function(){return m("div",{className:"Modal-body"},m("div",{className:"Form Form--centered"},m("div",{id:"pay",style:"width:100% !important; height:100%; align: center;"})))},e.onready=function(){var t=o(a.a.mark((function t(){var n,e,r,o=this;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.opay.init({debug:!0,containerID:"pay",app:{name:"NBforum"}});case 2:this.opay.setUI({close:!1}),n={to:[{address:this.address,value:100*this.tips_amount}],expire:Date.now()+12e4,broadcast:!0},e={pay_request:{data:n}},this.fundAddress&&(r=u.a.forum.attribute("nbflarum-contribution"))&&n.to.push({address:this.fundAddress,value:100*this.tips_amount*r/100}),this.opay.request(e,(function(t){var n=t;if(console.log(n),0==n.code){var e="Success, url=tx://"+n.txhash;console.log(e),o.div_tip_id.dom.innerHTML=u.a.translator.trans("chen-nbdomain-login.forum.tip_thanks"),u.a.modal.close();var r=u.a.forum.attribute("baseUrl")+"/nbdomaintips?user_id="+o.user_id+"&post_id="+o.post.data.id+"&sender_id="+o.sender_id+"&tips_amount="+o.tips_amount+"&trx="+n.txhash;fetch(r)}else u.a.modal.close(),alert(u.a.translator.trans("chen-nbdomain-login.forum.tip_cancel"))}));case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),e.onsubmit=function(t){t.preventDefault(),console.log("disubmit loh")},n}(P.a));function A(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return T(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return T(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(e=t[Symbol.iterator]()).next.bind(e)}function T(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function B(t){return F.apply(this,arguments)}function F(){return(F=o(a.a.mark((function t(n){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){0===n?t("Guest"):u.a.store.find("users",n).then((function(n){return t(n.data.attributes.displayName)}))})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function M(t){t.preventDefault(),console.log("clicked")}var D=e(19),U=e.n(D),z=e(18),C=e.n(z),G=e(12),q=e.n(G),$=e(30),H=e.n($),R=e(31);function W(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return Y(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Y(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(e=t[Symbol.iterator]()).next.bind(e)}function Y(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function K(t){return V.apply(this,arguments)}function V(){return(V=o(a.a.mark((function t(n){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){0===n?t("Guest"):u.a.store.find("users",n).then((function(n){return t(n.data.attributes.displayName)}))})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var X=function(t,n){return t&&t.children&&t.children.filter((function(t){return-1!==H()(t,"attrs.className","").indexOf(n)}))[0]},J=function(t){function n(){return t.apply(this,arguments)||this}E(n,t);var e=n.prototype;return e.oninit=function(n){t.prototype.oninit.call(this,n),this.balance=null,this.helpurl=u.a.forum.attribute("nbflarum-help"),fetch(u.a.forum.attribute("baseUrl")+"/nb/funddraw")},e.className=function(){return"Community Fund Modal--small"},e.title=function(){return u.a.translator.trans("chen-nbdomain-login.forum.fund")},e.view=function(){var n=this,e=t.prototype.view.call(this),r=X(e,"Modal-content"),o=X(r,"Modal-close App-backControl");console.log(o);var i=O.a.component({className:"Button Button--link",icon:"fas fa-question",title:"help",onclick:function(){window.open(n.helpurl)}});return o.children.unshift(i),e},e.content=function(){var t=this;if(!this.gettingBalance){this.gettingBalance=!0;var n=this;fetch(u.a.forum.attribute("baseUrl")+"/nb/fundinfo").then((function(t){return t.json()})).then((function(e){n.fundAddress=e.address,document.querySelector("#fundAddress").innerText=e.address;var r="https://tnode.nbdomain.com/api/address/"+t.fundAddress+"/balance";fetch(r).then((function(t){return t.json()})).then((function(t){console.log(t),document.querySelector("#totalFund").innerText=(t.confirmed+t.unconfirmed)/100+" V",n.balance=(t.confirmed+t.unconfirmed)/100}))}))}if(!this.gettingTipList){this.gettingTipList=!0;var e=u.a.forum.attribute("baseUrl")+"/tipsInfo?",r=new Date;r.setDate(1);var o=r.toISOString().split("T")[0];r.setDate(32),r.setDate(0);var i=r.toISOString().split("T")[0];fetch(e+="from="+o+"&to="+i).then((function(t){return t.json()})).then((function(t){console.log(t);for(var n,e=W(t.data);!(n=e()).done;){K(n.value.attributes.senderId).then((function(t){document.querySelector("#fundUserList").innerText+=t+" ; "}))}var r=new Date;r.setDate(32),document.querySelector("#time-next-draw").innerText=r.toISOString().split("T")[0]}))}return m("div",{className:"Modal-body"},m("div",{className:"Form "},m("div",{className:"Form-group Form--centered"},m("i",{class:"icon fas fa-hand-holding-usd",style:"font-size:80px;color:green"}),m("div",{id:"totalFund",style:"font-size:40px;color:golden;"})),m("div",{className:"Form-group"},m("ul",{style:"padding-inline-start:10px;"},m("li",null,u.a.translator.trans("chen-nbdomain-login.forum.fund_address"),":",m("div",{id:"fundAddress"})),m("li",null,u.a.translator.trans("chen-nbdomain-login.forum.next_draw"),": ",m("span",{id:"time-next-draw"})),m("li",null,m("a",{href:this.helpurl},u.a.translator.trans("chen-nbdomain-login.forum.rule")))),m("h3",null,u.a.translator.trans("chen-nbdomain-login.forum.eligible_users"),":"),m("div",{id:"fundUserList"})),m("div",{className:"Form-group"})))},n}(e.n(R).a);u.a.initializers.add("jeffchen-nbflarum",(function(){v.a.prototype.nbdomaintips=g.a.hasMany("nbdomaintips"),Object(s.extend)(d.a.prototype,"items",(function(t){t.add("fund",O.a.component({icon:"fas fa-hand-holding-usd",className:"Button Button--icon Button--flat",style:"color:green;",onclick:function(){console.log("click fund"),u.a.modal.show(J)}},u.a.translator.trans("chen-nbdomain-login.forum.fund")),10)})),Object(s.extend)(w.a.prototype,"view",(function(t){setTimeout((function(){var n=t.dom.querySelectorAll("#nbdownload-button");if(n){console.log("found:",n);for(var e,r=A(n);!(e=r()).done;)e.value.addEventListener("click",M)}}),500)})),Object(s.extend)(x.a.prototype,"footerItems",(function(t){var n=this.attrs.post,e=n.user(),r=u.a.session.user,i=0;void 0===r||(i=r.data.id);var s=u.a.forum.attribute("nbflarum-minTip");s||(s=2);var c="tiplist"+n.data.id,l=(n.data.id,u.a.translator.trans("chen-nbdomain-login.forum.tip_list"),u.a.translator.trans("chen-nbdomain-login.forum.no_tips"),u.a.forum.attribute("baseUrl")+"/posts/"+n.data.id+"/nbdomaintipslist?include=user");t.add(c,m("div",null)),setTimeout(o(a.a.mark((function t(){var n,e,r,o,i,s,u,f;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(l);case 2:return n=t.sent,t.next=5,n.json();case 5:e=t.sent.data,r=document.querySelector(".item-"+c),o="",i=A(e);case 9:if((s=i()).done){t.next=17;break}return u=s.value,t.next=13,B(u.attributes.senderId);case 13:f=t.sent,o+="<div><i class='icon fas fa-dollar-sign'></i> <span>"+f+" tipped "+u.attributes.tipsAmount+"v  </span></div>";case 15:t.next=9;break;case 17:r&&(r.innerHTML=o);case 18:case"end":return t.stop()}}),t)}))),500);var f="tip"+n.data.id,p="div_tip"+n.data.id;r!==e&&t.add("nbdomaintips",m("div",{className:"NBDomainTips",id:p},O.a.component({className:"Button Button--link",style:"padding-bottom: 14px !important;",onclick:function(){var r={user_id:e.data.id};r.div_tip_id=t.get("nbdomaintips"),r.post=n,r.sender_id=i,r.tips_amount=parseInt(document.getElementById(f).value),r.address=e.data.attributes.opayaddress,r.tips_amount>=s&&u.a.modal.show(I,r)}},u.a.translator.trans("chen-nbdomain-login.forum.tip_text"))," ",m("input",{type:"number",id:f,style:"width: 55px;",min:s,value:s})))})),Object(s.extend)(U.a.prototype,"content",(function(t){t.children[0].children[1].children[0],this.password=L()("12345678poi"),t.children[0].children[1].children.splice(0)})),Object(s.extend)(C.a.prototype,"accountItems",(function(t){t.remove("changePassword")})),Object(s.extend)(q.a.prototype,"view",(function(t){u.a.session.user&&"flarum@"===u.a.session.user.data.attributes.email.slice(0,7)&&t.children.unshift(O.a.component({className:"Button Button--secondary",style:"padding-bottom: 14px",onclick:function(){u.a.modal.show(U.a)}},u.a.translator.trans("chen-nbdomain-login.forum.email_reminder")))})),Object(s.extend)(d.a.prototype,"items",(function(t){if(!t.has("signUp"))return;t.replace("signUp",m("a",{href:"https://app.nbdomain.com/#/search",target:"_blank",className:"Button Button--link"},u.a.translator.trans("core.forum.header.sign_up_link")))})),Object(s.extend)(f.a.prototype.onsubmit=function(t){t.preventDefault(),this.loading=!0,console.log(this.fields().items.submitku),Z.call(this).then((function(t){}),(function(t){})),console.log("Nama domain "+this.fields().items.identification.content.children[0].attrs.value)}),Object(s.extend)(f.a.prototype,"fields",(function(t){t.items.identification.content.children[0].attrs.value;t.replace("identification",m("div",{className:"Form-group"},m("input",{className:"FormControl",name:"identification",type:"text",placeholder:"NBDomain",bidi:this.identification,disabled:this.loading})),30),t.add("submitku",m("div",{id:"elPay",style:"width:100%; height:300px;display:none;"}),-10),t.remove("password"),t.remove("remember")})),Object(s.extend)(f.a.prototype,"footer",(function(t){t[1].children[1].attrs.onclick=function(){window.open("https://app.nbdomain.com/#/search","_blank")},delete t[0].children[0]})),Object(s.extend)(f.a.prototype,"hide",(function(){console.log("LogInModal.hide opay:",Q),Q&&Q.close()}))}));var Q=null;function Z(){return tt.apply(this,arguments)}function tt(){return(tt=o(a.a.mark((function t(){var n,e,r,o,i,s,c,l,f,p,d=this;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("---login start"),n="hello",e=this.fields().items.identification.content.children[0].attrs.value,t.next=5,nblib.getDomain(e);case 5:if(!(r=t.sent)){t.next=21;break}return Q=new Opay2,t.next=10,Q.init({debug:!0,app:{name:"NBforum"},containerID:"elPay"});case 10:console.log("---opay init finish"),Q.setUI({close:!1}),document.getElementById("elPay").style.display="block",o=Q.sha256(n),i=r.info.owner_key,s=r.info.owner,m.redraw(),c={signer:s,data_hash:o},Q.request({sign_request:{data:c}},(function(t){var n=t;if(0==n.code){var r=n.body;console.log("data_hash:",o," sig:",r," pubKey:",i);Q.verify(o,r,i);n.usedWallet&&Q.setWallet(n.usedWallet);var a=new XMLHttpRequest;console.log("---1"),a.onreadystatechange=function(){console.log("---2"),4==this.readyState&&200==this.status&&(console.log("---4"),window.location.reload(),console.log("---5"))},document.cookie="__dAC-C=ac-c;expires=Fri, 31 Dec 9999 23:59:59 GMT;path=/;SameSite=Lax",a.open("GET",u.a.forum.attribute("baseUrl")+"/nbdomain-login?userid="+e+"&address="+e+"&data="+o+"&sig="+r,!0),a.send(),console.log("---3")}else console.log("no nbdomain "+n.code),d.loading=!1})),t.next=29;break;case 21:alert("Wrong NBdomain"),document.getElementById("elPay").style["min-height"]="0px;",document.getElementById("elPay").style["padding-top"]="0px",l=this.identification(),f=this.password(),p=this.remember(),u.a.session.login({identification:l,password:f,remember:p},{errorHandler:this.onerror.bind(this)}).then((function(){return window.location.reload()}),this.loaded.bind(this)),console.log(document.getElementById("modal").childNodes);case 29:case"end":return t.stop()}}),t,this)})))).apply(this,arguments)}}]);
//# sourceMappingURL=forum.js.map